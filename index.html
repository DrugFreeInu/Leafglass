<!DOCTYPE html>
<html>
<head>
  <title>leafglass</title>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <style>
    body {
      background: #ffffff;
      text-align: center;
    }

    .leafpic {
      width: 400px;
      border: 4px solid black;
      margin: 40px auto;
      display: block;
    }

    #keyed {
      border: 4px solid black;
      margin: 40px auto;
      display: block;
    }
  </style>
</head>
<body>

  <img class="leafpic" src="9C0FB4CC-FA9E-4434-BAB2-C7F2F55F9464.png">

  <canvas id="keyed"></canvas>

  <script>
    const target = { r: 0, g: 255, b: 0 }; // pure green
    const tolerance = 120; // determines how close to green it must be

    const img = new Image();
    img.src = "4FB1A1AB-8FE2-4160-9EC8-2D7867D028B3.png";

    img.onload = () => {
      const canvas = document.getElementById("keyed");
      canvas.width = img.width;
      canvas.height = img.height;

      const ctx = canvas.getContext("2d");
      ctx.drawImage(img, 0, 0);

      let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      let data = imageData.data;

      for (let i = 0; i < data.length; i += 4) {
        let r = data[i];
        let g = data[i + 1];
        let b = data[i + 2];

        // compute color distance to pure green
        let dist =
          Math.sqrt(
            (r - target.r) ** 2 +
            (g - target.g) ** 2 +
            (b - target.b) ** 2
          );

        // if it's close enough to green, remove it
        if (dist < tolerance) {
          data[i + 3] = 0; // transparent
        }
      }

      ctx.putImageData(imageData, 0, 0);
    };
  </script>

</body>
</html>
